# Financial Advisor Agent

This project provides a multi-agent system designed to assist financial advisors by performing market analysis, developing trading strategies, and evaluating risk.

## Disclaimer

**For Educational and Informational Purposes Only.**

The information and trading strategy outlines provided by this tool, including any analysis, commentary, or potential scenarios, are generated by an AI model and are for educational and informational purposes only. They do not constitute, and should not be interpreted as, financial advice, investment recommendations, endorsements, or offers to buy or sell any securities or other financial instruments.

Google and its affiliates make no representations or warranties of any kind, express or implied, about the completeness, accuracy, reliability, suitability, or availability with respect to the information provided. Any reliance you place on such information is therefore strictly at your own risk.

## Architecture

The system is composed of a team of specialized AI agents that collaborate to provide financial insights.

*   **Data Analyst Agent:** Gathers and analyzes market data for specified stock tickers.
*   **Trading Analyst Agent:** Develops trading strategies based on market analysis and user-defined risk profiles.
*   **Execution Agent:** Creates detailed plans for implementing trading strategies.
*   **Risk Evaluation Agent:** Analyzes the risks associated with the proposed strategies and execution plans.

This diagram shows the detailed architecture of the agents and tools used:
<img src="financial-advisor.png" alt="Financial Advisor" width="800"/>

### Technology Stack

*   **Backend:** Python 3.12
*   **Dependency Management:** Poetry
*   **Containerization:** Docker
*   **Cloud Provider:** Google Cloud Platform (GCP)
*   **Infrastructure as Code:** Terraform
*   **Services:**
    *   Vertex AI Agent Engine (for hosting the agent)
    *   Google Cloud SQL (for the database)
    *   Google Secret Manager (for managing secrets)
*   **CI/CD:** Google Cloud Build

## Prerequisites

Before you begin, ensure you have the following tools installed:

*   Python 3.12+
*   Poetry
*   Docker
*   Google Cloud CLI

## Local Development

### 1. Clone the Repository

```bash
git clone https://github.com/your-username/adk-trade.git
cd adk-trade
```

### 2. Configure Environment Variables

Create a `.env` file in the root of the project by copying the example file:

```bash
cp .env.example .env
```

Now, edit the `.env` file and fill in the required values for your local environment.

### 3. Install Dependencies

Install the project dependencies using Poetry:

```bash
poetry install
```

### 4. Run the Application

To run the trade scanner script directly:

```bash
poetry run python run_trade_scanner.py
```

### 5. Running Tests

To run the test suite, first install the development dependencies:

```bash
poetry install --with dev
```

Then, run pytest:

```bash
pytest
```

## Deployment to Google Cloud

This project is deployed to Google Cloud using a CI/CD pipeline defined in `cloudbuild.yaml`. The pipeline automates the provisioning of infrastructure and the deployment of the financial advisor agent.

### How it Works

The pipeline is typically triggered on pushes to the main branch and performs the following steps:

1.  **Enable APIs:** Ensures all necessary Google Cloud APIs (Vertex AI, Cloud SQL, etc.) are enabled.
2.  **Grant Permissions:** Assigns necessary IAM roles to the Cloud Build service account to manage infrastructure and deploy the agent.
3.  **Create GCS Bucket:** Creates a Google Cloud Storage bucket to store the Terraform state and serve as a staging area for Agent Engine.
4.  **Provision Infrastructure with Terraform:** Runs `terraform apply` to create:
    *   A Google Cloud SQL instance with a public IP.
    *   A database and user.
    *   Secrets in Google Secret Manager for the database password and public IP address.
5.  **Deploy to Agent Engine:** Runs a Python script (`deployment/deploy.py`) to package and deploy the agent code to Vertex AI Agent Engine. The agent code is written to securely fetch its database credentials from Secret Manager at runtime.

### Manual Deployment & Testing

You can also deploy and test the agent manually using the provided scripts. Ensure your local environment is authenticated with `gcloud auth application-default login` and your `GOOGLE_CLOUD_PROJECT`, `GOOGLE_CLOUD_LOCATION`, and a staging `GOOGLE_CLOUD_STORAGE_BUCKET` are set as environment variables.

*   **Create/Update the Agent:** `poetry run python -m deployment.deploy --create`
*   **Test an Agent:** `poetry run python -m deployment.test_deployment --resource_id <AGENT_RESOURCE_ID> --user_id test-user`

### Triggering a Deployment

1.  **Configure a Cloud Build Trigger:** In your Google Cloud project, create a new Cloud Build trigger connected to your repository. Configure it to use the `cloudbuild.yaml` file from the repository and to trigger on pushes to the `main` branch.
2.  **Push to `main`:** Push your changes to the `main` branch of your repository. This will automatically trigger the deployment pipeline.

You can monitor the build and deployment progress in the Cloud Build section of the Google Cloud Console.